name: Working Config Test

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup (Minimal)
      run: |
        sudo apt update
        sudo apt install -y build-essential gcc-aarch64-linux-gnu bc flex bison libelf-dev

    - name: Build (Simple)
      run: |
        # ç»å¯¹æœ€ç®€å•çš„æ„å»ºå‘½ä»¤
        ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- make alioth_defconfig
        echo "âœ… é…ç½®å®Œæˆ"
        
        ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- make -j2
        echo "âœ… æ„å»ºå®Œæˆ"
        
        # æ£€æŸ¥è¾“å‡º
        if [ -f "arch/arm64/boot/Image.gz-dtb" ]; then
          echo "ğŸ‰ æ„å»ºæˆåŠŸï¼"
          ls -lh arch/arm64/boot/Image.gz-dtb
        else
          echo "âŒ æ— è¾“å‡ºæ–‡ä»¶"
          find . -name "Image*" -type f | head -10
        fi
